(()=>{"use strict";function e(e,t,i){let r=!1,n=[],o=[{y:0,x:0},{y:1,x:1},{y:2,x:2}],l=[{y:0,x:2},{y:1,x:1},{y:2,x:0}];for(let e=0;e<3;e++)if(o[e].y==i.y&&o[e].x==i.x){r=!0;break}if(r){for(let t=0;t<2;t++){if(e[t][t].figure!=e[t+1][t+1].figure){n.push(!1);break}n.push(!0)}let i=n.find((e=>0==e));if(i=0==i,!i){let e=document.createElement("canvas");e.setAttribute("width",300),e.setAttribute("height",300);const i=e.getContext("2d");i.beginPath(),i.moveTo(0,0),i.lineTo(300,300),i.lineWidth=6,i.strokeStyle="#f00",i.stroke(),t.appendChild(e)}return!!i}for(let e=0;e<3;e++)if(l[e].y==i.y&&l[e].x==i.x){r=!0;break}if(r){for(let t=2;t>0;t--){if(e[Math.abs(t-2)][t].figure!=e[Math.abs(t-3)][t-1].figure){n.push(!1);break}n.push(!0),console.log(e[t])}let i=n.find((e=>0==e));if(i=0==i,!i){let e=document.createElement("canvas");e.setAttribute("width",300),e.setAttribute("height",300);const i=e.getContext("2d");i.beginPath(),i.moveTo(300,0),i.lineTo(0,300),i.lineWidth=6,i.strokeStyle="#f00",i.stroke(),t.appendChild(e)}return!!i}return!0}function t(e,t,i){let r=[],n=0;for(;n!=e[i.y].length-1;){if(e[i.y][n].figure!=e[i.y][n+1].figure){r.push(!1);break}r.push(!0),n++}let o=r.find((e=>0==e));if(o=0==o,!o){let e=document.createElement("div");e.classList.add("line"),e.style.width="300px",e.style.height="4px",e.style.left="0",t.appendChild(e)}return!!o}function i(e,t,i){let r=[],n=0;for(;n!=e[i.x].length-1;){if(e[n][i.x].figure!=e[n+1][i.x].figure){r.push(!1);break}r.push(!0),n++}let o=r.find((e=>0==e));if(o=0==o,!o){let e=document.createElement("div");e.classList.add("line"),e.style.width="4px",e.style.height="300px",e.style.top="0",t.appendChild(e)}return!!o}function r({Game:r,cell:n}){if(r.game){let o=document.createElement("p");r.moveXO?o.innerText="X":o.innerText="O";let l=r.game,s={y:+n.getAttribute("y"),x:+n.getAttribute("x")};if(null==r.board[s.y][s.x].figure&&(n.appendChild(o),r.setBoard(s),l=function(r,n,o){let l=[t,i,e];for(let e of l){let t=e(r,n,o);if(!t)return t}return!0}(r.board,n,s),l&&r.setMoveXO()),!l)return r.gameEnd(),!1;r.counterInc(),9==r.movesCounter&&r.gameEnd()}}const n={board:[],moveXO:!0,movesCounter:0,game:!0,setBoard({y:e,x:t}){console.log(this),this.board[e][t].figure=this.moveXO?"X":"O"},setMoveXO(){this.moveXO=!this.moveXO},counterInc(){this.movesCounter++},gameEnd(){this.game=!1,document.querySelector("#board").classList.add("disable")},resetFields(){this.board=[],this.moveXO=this.game=!0,this.movesCounter=0}};let o=function(){let e=document.createElement("div");e.setAttribute("id","board"),document.querySelector("#game").appendChild(e);for(let t=0;t<3;t++){this.board.push([]);for(let i=0;i<3;i++){this.board[t].push({figure:null,cellCord:{y:t,x:i}});let n=document.createElement("div");n.classList.add("cell"),n.setAttribute("y",t),n.setAttribute("x",i),n.addEventListener("click",(()=>{r({Game:this,cell:n})})),e.appendChild(n)}}this.moveXO=!0}.bind(n);o(),document.querySelector("#restart").addEventListener("click",(()=>{!function(e){document.querySelector("#board").remove(),e.resetFields()}(n),o()}))})();